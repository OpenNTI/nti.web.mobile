<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: common/Utils.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: common/Utils.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>"use strict";
/**
* @class Utils
*/
var Utils = {
	getLink: function(o, rel) {
		if (o && o.Links) { o = o.Links; }

		var v, i = o.length - 1;
		for (i; i>=0; i--) {
			v = o[i];
			if (v && v.rel === rel) {
				return v;
			}
		}
	},
	/**
	* Make a server request.
	* @method call
	* @param url {String} The url to request
	* @param data {mixed} An object or query string to submit as part of the request
	* @param callback {function} The function to invoke upon request completion
	* @param forceMethod {String} Force the request to use this method (e.g. 'GET' or 'POST')
	*/
	call: function(url,data,callback,forceMethod) {
		var username = data? data.username : undefined,
			password = data? data.password : undefined,
			auth = password? ('Basic '+btoa(username+':'+password)) : undefined,
			m = forceMethod? forceMethod : data? 'POST':'GET',
			l = url,/* + "?dc="+(new Date().getTime()),*/
			f = { withCredentials: true },
			h = {
				Accept:'application/json',
				Authorization:auth,
				'Content-Type':'application/x-www-form-urlencoded'
			};

		if(!auth){ delete h.Authorization; f = {}; }
		if(!data) { delete h['Content-Type']; }

		if (m === 'GET' && data){
			delete data.password;
			delete data.remember;
			delete data.username;
		}

		var x = $.ajax({
			xhrFields: f,
			url: l,
			type: m,
			headers: h,
			data: data,
			dataType: 'json'
		}).fail(function(jqXHR, textStatus){
			//console.error('The request failed. Server up? CORS?\nURL: '+l, textStatus, jqXHR.status);
			if(callback){ callback.call(window, jqXHR.status ); }
		}).done(function(data){
			if(callback){ callback.call(window, data || x.status ); }
		});
	},

	/**
	* Serializes an object to be submitted as part of an web/ajax request.
	* @method toQueryString
	* @param {Object} obj The object to serialize.
	* @return {String} Serialized, URI-encoded, querystring form of the given object.
	*/
	toQueryString: function(obj) {
		var k, t,string = [];
		for(k in o){
			if(o.hasOwnProperty(k)){
				t = typeof o[k];
				if(t==='string' || t==='boolean' || t==='number') {
					string.push([encodeURIComponent(k),encodeURIComponent(o[k])].join('='));
				} else {
					console.log(typeof o[k], k, o[k]);
				}
			}
		}
		return string.join('&');
	},

	/*
	* Maps the given object array, indexed by element[key].
	* Example:
	* var in = [{name:'banana', color:'yellow'}, {name:'apple', color:'red'}];
	* Utils.indexArrayByKey(in,'name') returns:
	* {
	* 	'banana': {name:'banana', color:'yellow'},
	* 	'apple': {name:'apple', color:'red'}
	* }
	* Note: No attempt is made to prevent items with
	* the same key from stomping each other.
	*/
	indexArrayByKey: function(arr, key) {
		var result = {};
		arr.forEach(function(item) {
			result[item[key]] = item;
		});
		return result;
	}
}

module.exports = Utils;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="module-login.html">login</a></li><li><a href="LoginActions.html">login/LoginActions</a></li><li><a href="module-nt-mobile.html">nt-mobile</a></li></ul><h3>Classes</h3><ul><li><a href="AppConfig.html">AppConfig</a></li><li><a href="Button.html">Button</a></li><li><a href="DebugInfo.html">DebugInfo</a></li><li><a href="HTTP_STATUS_CODES.html">HTTP_STATUS_CODES</a></li><li><a href="LoginConstants.html">LoginConstants</a></li><li><a href="LoginController.html">LoginController</a></li><li><a href="LoginForm.html">LoginForm</a></li><li><a href="LoginPanel.html">LoginPanel</a></li><li><a href="ResponseHandlers.html">ResponseHandlers</a></li><li><a href="Utils.html">Utils</a></li></ul><h3>Events</h3><ul><li><a href="global.html#event:LOGIN_FORM_CHANGED">LOGIN_FORM_CHANGED</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addChangeListener">addChangeListener</a></li><li><a href="global.html#begin">begin</a></li><li><a href="global.html#call">call</a></li><li><a href="global.html#canDoPasswordLogin">canDoPasswordLogin</a></li><li><a href="global.html#Dispatcher">Dispatcher</a></li><li><a href="global.html#fail">fail</a></li><li><a href="global.html#getHref">getHref</a></li><li><a href="global.html#handleSubmit">handleSubmit</a></li><li><a href="global.html#handleViewAction">handleViewAction</a></li><li><a href="global.html#invariant">invariant</a></li><li><a href="global.html#isLoggedIn">isLoggedIn</a></li><li><a href="global.html#log_in">log_in</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#LOGIN_BEGIN">LOGIN_BEGIN</a></li><li><a href="global.html#LOGIN_FAILURE">LOGIN_FAILURE</a></li><li><a href="global.html#LOGIN_LINKS_CHANGED">LOGIN_LINKS_CHANGED</a></li><li><a href="global.html#LOGIN_PASSWORD">LOGIN_PASSWORD</a></li><li><a href="global.html#LOGIN_SUCCESS">LOGIN_SUCCESS</a></li><li><a href="global.html#logOut">logOut</a></li><li><a href="global.html#pong">pong</a></li><li><a href="global.html#React">React</a></li><li><a href="global.html#removeChangeListener">removeChangeListener</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#setState">setState</a></li><li><a href="global.html#toQueryString">toQueryString</a></li><li><a href="global.html#UPDATE_LINKS">UPDATE_LINKS</a></li><li><a href="global.html#updateLinks">updateLinks</a></li><li><a href="global.html#usernameChanged">usernameChanged</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Tue Aug 19 2014 17:04:08 GMT-0500 (CDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
